
<!DOCTYPE html>


<html lang="zh-CN" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>home_security_surveillance.Ui.ui &#8212; home_security_surveillance 1.5 文档</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=362ab14a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=a8cb9c0f"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/translations.js?v=beaddf03"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/home_security_surveillance/Ui/ui';</script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="zh-CN"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">home_security_surveillance 1.5 文档</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">搜索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">搜索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">模块代码</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">home_securit...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>home_security_surveillance.Ui.ui 源代码</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File Name: ui.py</span>
<span class="sd">Author: Captain</span>
<span class="sd">Date: 2024-06-06</span>
<span class="sd">Version: 1.5</span>
<span class="sd">Description: 提供简洁的图形化界面</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># 引入常用库</span>
<span class="kn">from</span> <span class="nn">home_security_surveillance.Common</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># 引入Warning_Processor库</span>
<span class="kn">from</span> <span class="nn">home_security_surveillance.Exception_process.Warning_Processor</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># 引入video_processor库</span>
<span class="kn">from</span> <span class="nn">home_security_surveillance.Video_process</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># 引入Log_Processor库</span>
<span class="kn">from</span> <span class="nn">home_security_surveillance.File_process</span> <span class="kn">import</span> <span class="n">Log_Processor</span>
<span class="c1"># 引入messagebox类</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="c1"># 引入psutil库</span>
<span class="kn">import</span> <span class="nn">psutil</span>
<span class="c1"># 引入sys库</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;VideoMonitorApp&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="VideoMonitorApp">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp">[文档]</a>
<span class="k">class</span> <span class="nc">VideoMonitorApp</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VideoMonitorApp(root)</span>

<span class="sd">    根据用户的操作完成相应的家庭监控设置和分析，是家庭监控系统的用户交互和任务分发部分</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    root : tk.TK</span>
<span class="sd">        用于创建和用户进行交互的主窗口</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    root : tk.TK</span>
<span class="sd">        和用户进行交互的主窗口，在上面可以定义各种控件</span>
<span class="sd">    video_processor : Video_Processor</span>
<span class="sd">        视频流处理器的一个实例，此处是一个静态实例，不执行任务，主要用于获得各种视频设备和视频文件信息</span>
<span class="sd">    process_type : int</span>
<span class="sd">        执行任务的进程对应的进程类型，0表示没有执行任务的进程，1表示执行加载和处理本地历史视频任务的进程，</span>
<span class="sd">        2表示执行加载和处理本地视频设备任务的进程，3表示执行加载和处理网络视频设备任务的进程</span>
<span class="sd">    processes : multiprocessing.Process</span>
<span class="sd">        存储multiprocessing进程对象的成员变量，是执行任务进程的句柄</span>
<span class="sd">    shared_value : multiprocessing.Value</span>
<span class="sd">        为其他进程所共享的共享内存对象，创建为一个整型，默认为-10，用于保存其他进程的返回值</span>
<span class="sd">        根据不为-10的返回值可以确定错误情况</span>
<span class="sd">    shared_event : multiprocessing.Event</span>
<span class="sd">        进程事件通信对象，用于通知执行任务进程是否停止，每次创建执行任务进程时刷新</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    在该类中加载了静态视频处理对象，每次创建进程执行任务时需要加载一个动态的视频处理对象，此时不会产生IO冲突</span>
<span class="sd">    类内创建了各种控件，此处不再一一说明</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">:</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;家庭视频监控软件&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s2">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_closing</span><span class="p">)</span>
        <span class="c1"># 类内的默认处理器对象，用于在Video_Processor中的获得相关信息</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span> <span class="o">=</span> <span class="n">Video_Processor</span><span class="p">()</span>
        <span class="c1"># 进程类型和进程对象</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># 创建共享变量和进程事件</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Value</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">380</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_font</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;微软雅黑&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TLabel&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TButton&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TCheckbutton&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TRadiobutton&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TEntry&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TMenubutton&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_widgets</span><span class="p">()</span>

<div class="viewcode-block" id="VideoMonitorApp.center_window">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.center_window">[文档]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">center_window</span><span class="p">(</span><span class="n">window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">],</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        窗口居中设置函数，静态方法</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        window : Union[tk.Toplevel, tk.TK]</span>
<span class="sd">            要设置居中的窗口对象，可以是主窗口或者其他顶层窗口</span>
<span class="sd">        width : int</span>
<span class="sd">            窗口的宽度</span>
<span class="sd">        height : int</span>
<span class="sd">            窗口的高度</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 获取屏幕宽度和高度</span>
        <span class="n">screen_width</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">()</span>
        <span class="n">screen_height</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">()</span>
        <span class="c1"># 计算窗口左上角坐标</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">screen_width</span> <span class="o">-</span> <span class="n">width</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">screen_height</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="c1"># 设置窗口大小和位置</span>
        <span class="n">window</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s1">+</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">+</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.create_widgets">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.create_widgets">[文档]</a>
    <span class="k">def</span> <span class="nf">create_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;添加窗口组件函数，用于创建大部分主窗口上的组件&quot;&quot;&quot;</span>
        <span class="c1"># 选择视频来源</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择视频来源:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;本地摄像设备&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;本地历史视频&quot;</span><span class="p">,</span> <span class="s2">&quot;本地摄像设备&quot;</span><span class="p">,</span> <span class="s2">&quot;网络摄像设备&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">source_options</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">confirm_source</span><span class="p">)</span>
        <span class="c1"># self.source_menu.configure(font=label_font)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_url</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># 选择可用设备或视频</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择可用设备:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>

        <span class="c1"># 选择处理方式</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_mode_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择处理方式:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_mode_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom1</span><span class="p">)</span>
        <span class="n">c1</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility_check</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;可视化&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="p">,</span>
                                                <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_check</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;检测&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span><span class="p">,</span>
                                            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;录制&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_var</span><span class="p">,</span>
                                          <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># 选择检测类型</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择检测类型:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;全部&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;全部&quot;</span><span class="p">,</span> <span class="s2">&quot;火焰&quot;</span><span class="p">,</span> <span class="s2">&quot;人员&quot;</span><span class="p">,</span> <span class="s2">&quot;异常情况&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_type_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detect_type_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

        <span class="c1"># 检测敏感度</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;检测敏感度:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom2</span><span class="p">)</span>
        <span class="n">c2</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_low</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;低&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_low</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_high</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;高&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_high</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># 开始和停止按钮</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom3</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom3</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c3</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;开始&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;停止&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_monitoring</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;邮件管理&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">email_manage</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


        <span class="c1"># 测试按钮</span>
        <span class="c1"># self.start_button = ttk.Button(self.root, text=&quot;测试&quot;, command=self.start_test)</span>
        <span class="c1"># self.start_button.grid(row=6, column=0, pady=10)</span>

        <span class="c1"># 用于确认视频来源</span>

<div class="viewcode-block" id="VideoMonitorApp.check_start">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.check_start">[文档]</a>
    <span class="k">def</span> <span class="nf">check_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        根据三个Checkbutton对应的Var的状态，检查开始按钮是否可以点击</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_var</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">DISABLED</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为不可用</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为可用</span></div>


<div class="viewcode-block" id="VideoMonitorApp.confirm_source">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.confirm_source">[文档]</a>
    <span class="k">def</span> <span class="nf">confirm_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        确定资源信息函数，用于选择视频设备类型时的处理，与主窗口选择视频类型的操作列表绑定</span>
<span class="sd">        此处在有需要时会在主窗口上创建子窗口完成相应处理</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            读取到的用户选择的视频设备类型字符串名陈</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 根据不同选择进行组件的不同处理</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;本地摄像设备&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择可用设备:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">input_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">input_window</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">cancel</span><span class="p">())</span>  <span class="c1"># 将关闭按钮与取消函数关联</span>
        <span class="n">input_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>

        <span class="c1"># 子函数，用于选择url地址</span>
        <span class="k">def</span> <span class="nf">choose_address</span><span class="p">(</span><span class="n">sub_value</span><span class="p">):</span>
            <span class="n">input_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">sub_value</span><span class="p">)</span>

        <span class="n">input_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">input_var</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;本地历史视频&quot;</span><span class="p">:</span>
            <span class="n">input_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">input_entry</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;示例: 1949-10-01&#39;</span><span class="p">)</span>
            <span class="n">input_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;输入视频日期&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">125</span><span class="p">)</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;输入视频日期:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">on_entry_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">input_entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;示例: 1949-10-01&#39;</span><span class="p">:</span>
                    <span class="n">input_entry</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>  <span class="c1"># 清空当前内容</span>
                    <span class="n">input_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># 恢复正常文本颜色</span>

            <span class="n">input_entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s1">&#39;&lt;FocusIn&gt;&#39;</span><span class="p">,</span> <span class="n">on_entry_click</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择可用视频:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;网络摄像设备&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">input_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;输入摄像头地址&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;输入设备地址:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">address_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择已有地址:&quot;</span><span class="p">)</span>
            <span class="n">address_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">nvd_processor</span><span class="o">.</span><span class="n">nvd_config_data</span><span class="p">]</span>
            <span class="n">address_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
            <span class="n">address_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">address_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">url_list</span>
            <span class="n">address_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="n">input_window</span><span class="p">,</span> <span class="n">address_var</span><span class="p">,</span> <span class="o">*</span><span class="n">address_options</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">choose_address</span><span class="p">)</span>
            <span class="n">address_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
            <span class="n">address_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;选择可用设备:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">input_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">submit</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;提交子函数，与子窗口的“提交”按钮绑定，规定了子窗口时的交互行为&quot;&quot;&quot;</span>
            <span class="c1"># 获得提交信息，根据信息进行不同的处理</span>
            <span class="n">input_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_url</span> <span class="o">=</span> <span class="n">input_entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;本地历史视频&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">video_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">hs_processor</span><span class="o">.</span><span class="n">hv_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;日期格式错误或该日期下无视频</span><span class="se">\n</span><span class="s2">请重新输入日期&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># 取消已选项目</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 删除可选项目</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span>
                                                            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">video_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">video_list</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid_remove</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;网络摄像设备&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
            <span class="n">input_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
            <span class="k">return</span>

        <span class="k">def</span> <span class="nf">cancel</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;取消子函数，与子窗口的&quot;取消&quot;按钮绑定，规定了子窗口时的交互行为&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;本地历史视频&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_check</span><span class="o">.</span><span class="n">grid_remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># 取消已选项目</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 删除可选项目</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>
            <span class="n">input_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
            <span class="k">return</span>

        <span class="c1"># 创建子窗口时使用</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">input_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bottom</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">submit_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;提交&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">submit</span><span class="p">)</span>
        <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;取消&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">cancel</span><span class="p">)</span>
        <span class="n">submit_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">cancel_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish setting </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.start_monitoring">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.start_monitoring">[文档]</a>
    <span class="k">def</span> <span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        与主窗口的“开始”按钮绑定，用于创建执行任务的子进程</span>
<span class="sd">        与其他模块进行交互，是连接前后端的关键函数</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">DISABLED</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为不可用</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">DISABLED</span><span class="p">)</span>  <span class="c1"># 将&quot;邮件管理&quot;按钮设为不可用</span>
        <span class="n">type_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;全部&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;火焰&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;人员&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;异常情况&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
        <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># 重建共享变量和进程事件</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>

        <span class="c1"># 根据用户选择的不同资源信息进行进程创建和任务执行</span>
        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;本地历史视频&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">video_index_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">hs_processor</span><span class="o">.</span><span class="n">hv_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">history_video_process_workder</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;shared_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="p">,</span>
                    <span class="s2">&quot;shared_event&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span><span class="p">,</span>
                    <span class="s2">&quot;video_strat_save_date&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">,</span>
                    <span class="s2">&quot;video_index&quot;</span><span class="p">:</span> <span class="n">video_index_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">get</span><span class="p">()],</span>
                    <span class="s2">&quot;flag_visibility&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;flag_re_detect&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;video_detect_type&quot;</span><span class="p">:</span> <span class="n">type_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span><span class="o">.</span><span class="n">get</span><span class="p">()]})</span>
            <span class="c1"># 断言processes是一个进程对象</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;本地摄像设备&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">device_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">local_process_workder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;shared_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="p">,</span>
                    <span class="s2">&quot;shared_event&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span><span class="p">,</span>
                    <span class="s2">&quot;video_sourse&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">device_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">get</span><span class="p">()]),</span>
                    <span class="s2">&quot;flag_visibility&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;flag_save&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;flag_detect&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;video_detect_sensitivity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;video_detect_type&quot;</span><span class="p">:</span> <span class="n">type_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span><span class="o">.</span><span class="n">get</span><span class="p">()]})</span>
            <span class="c1"># 断言processes是一个进程对象</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;网络摄像设备&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_process_workder</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;shared_value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="p">,</span>
                    <span class="s2">&quot;shared_event&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span><span class="p">,</span>
                    <span class="s2">&quot;video_sourse&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_url</span><span class="p">,</span>
                    <span class="s2">&quot;flag_visibility&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;flag_save&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;flag_detect&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;video_detect_sensitivity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="s2">&quot;video_detect_type&quot;</span><span class="p">:</span> <span class="n">type_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_type_var</span><span class="o">.</span><span class="n">get</span><span class="p">()]}),</span>
            <span class="c1"># 断言processes是一个进程对象</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start the </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> worker process&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;开始执行任务&quot;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;正在初始化任务中，请稍等&quot;</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span></div>


<div class="viewcode-block" id="VideoMonitorApp.stop_monitoring">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.stop_monitoring">[文档]</a>
    <span class="k">def</span> <span class="nf">stop_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        与主窗口的“停止”按钮绑定，用于停止当前执行任务，恢复ui界面的子进程</span>
<span class="sd">        与其他模块进行交互，同样是连接前后端的关键函数</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 如果没有执行任务的进程不做任何处理</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># 传递关闭信息</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;已退出监控&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为可用</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;邮件管理&quot;按钮设为可用</span>
            <span class="c1"># 不再处理进程退出的结果</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish the worker process&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.on_closing">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.on_closing">[文档]</a>
    <span class="k">def</span> <span class="nf">on_closing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        与主窗口右上角退出的按钮绑定，用于退出整个进程，关闭全部子进程</span>
<span class="sd">        通过进程树的方式杀死子进程</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 如果子进程存在</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
            <span class="c1"># 递归终止所有子进程</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">child</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exit the home security surveillance system. &quot;</span>
                                                  <span class="sa">f</span><span class="s2">&quot;Thanks for your using!&quot;</span><span class="p">,</span>
                                                  <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="c1"># 确保退出程序</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.email_manage">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.email_manage">[文档]</a>
    <span class="k">def</span> <span class="nf">email_manage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        与主窗口的“邮件处理”按钮绑定，用于帮助用户管理邮件信息</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 创建子窗口用于和用户交互处理邮件信息</span>
        <span class="n">email_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">email_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;邮件管理&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">220</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">email_window</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">confirm</span><span class="p">())</span>  <span class="c1"># 将关闭按钮与取消函数关联</span>

        <span class="k">def</span> <span class="nf">confirm</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;与邮件处理窗口的提交按钮绑定&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
            <span class="n">email_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
            <span class="k">return</span>

        <span class="k">def</span> <span class="nf">change_sender</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;用户修改发件人按钮绑定&quot;&quot;&quot;</span>
            <span class="n">change_sender_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">email_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
            <span class="n">change_sender_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;更换发件人&quot;</span><span class="p">)</span>
            <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">change_sender_window</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">cancel_sender_email</span><span class="p">())</span>  <span class="c1"># 将关闭按钮与取消函数关联</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">email_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;邮箱:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">email_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;密码:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">input_email</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
            <span class="n">input_email_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">input_email</span><span class="p">,</span>
                                          <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">input_email_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">input_password</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
            <span class="n">input_password_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">input_password</span><span class="p">,</span>
                                             <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">input_password_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">confirm_sender_email</span><span class="p">():</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;验证修改发件人窗口的按钮绑定&quot;&quot;&quot;</span>
                <span class="n">warning_processor</span> <span class="o">=</span> <span class="n">Warning_Processor</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">warning_processor</span><span class="o">.</span><span class="n">append_email_senter</span><span class="p">(</span><span class="n">input_email</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">input_password</span><span class="o">.</span><span class="n">get</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sender_info_label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sender_info_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">warning_processor</span><span class="o">.</span><span class="n">email_senter_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sender_info_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish appending sender&quot;</span><span class="p">,</span>
                                                          <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;更改失败，请检查邮箱地址或密码是否正确&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to append sender, please check the input&quot;</span><span class="p">,</span>
                                                          <span class="n">Log_Processor</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
                <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
                <span class="n">change_sender_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
                <span class="k">return</span>

            <span class="k">def</span> <span class="nf">cancel_sender_email</span><span class="p">():</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;取消修改发件人窗口的按钮绑定&quot;&quot;&quot;</span>
                <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
                <span class="n">change_sender_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
                <span class="k">return</span>

            <span class="n">bottom</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">change_sender_window</span><span class="p">)</span>
            <span class="n">bottom</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">confirm_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;提交&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">confirm_sender_email</span><span class="p">)</span>
            <span class="n">confirm_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;取消&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">cancel_sender_email</span><span class="p">)</span>
            <span class="n">cancel_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">append_receiver</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;用户添加收件人的按钮绑定&quot;&quot;&quot;</span>
            <span class="n">append_receiver_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">email_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_window</span><span class="p">(</span><span class="n">append_receiver_window</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
            <span class="n">append_receiver_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;添加收件人&quot;</span><span class="p">)</span>
            <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">append_receiver_window</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">cancel_receiver_email</span><span class="p">())</span>  <span class="c1"># 将关闭按钮与取消函数关联</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">email_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">append_receiver_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;邮箱:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">email_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">input_email</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
            <span class="n">input_email_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">append_receiver_window</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">input_email</span><span class="p">,</span>
                                          <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">input_email_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">confirm_receiver_email</span><span class="p">():</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;验证修改收件人窗口的按钮绑定&quot;&quot;&quot;</span>
                <span class="n">warning_processor</span> <span class="o">=</span> <span class="n">Warning_Processor</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">warning_processor</span><span class="o">.</span><span class="n">append_email_receiver</span><span class="p">(</span><span class="n">input_email</span><span class="o">.</span><span class="n">get</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">input_email</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish appending receiver.&quot;</span><span class="p">,</span>
                                                              <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">input_email</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to append receiver, the address is exist&quot;</span><span class="p">,</span>
                                                              <span class="n">Log_Processor</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
                        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;添加失败，该邮箱地址已存在&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to append receiver, please check the input&quot;</span><span class="p">,</span>
                                                          <span class="n">Log_Processor</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;添加失败，请检查邮箱地址是否正确&quot;</span><span class="p">)</span>
                <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
                <span class="n">append_receiver_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
                <span class="k">return</span>

            <span class="k">def</span> <span class="nf">cancel_receiver_email</span><span class="p">():</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;取消修改收件人窗口的按钮绑定&quot;&quot;&quot;</span>
                <span class="n">email_window</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="s1">&#39;-disabled&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 将主窗口设为可用</span>
                <span class="n">append_receiver_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>  <span class="c1"># 关闭窗口</span>
                <span class="k">return</span>

            <span class="n">bottom</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">append_receiver_window</span><span class="p">)</span>
            <span class="n">bottom</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">confirm_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;提交&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">confirm_receiver_email</span><span class="p">)</span>
            <span class="n">confirm_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;取消&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">cancel_receiver_email</span><span class="p">)</span>
            <span class="n">cancel_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">delete_receiver</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;用户删除收件人的按钮绑定&quot;&quot;&quot;</span>
            <span class="n">selected_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">curselection</span><span class="p">()</span>
            <span class="n">warning_processor</span> <span class="o">=</span> <span class="n">Warning_Processor</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">warning_processor</span><span class="o">.</span><span class="n">delete_email_receiver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish deleting receiver.&quot;</span><span class="p">,</span>
                                                          <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fail to delete receiver, please check the input&quot;</span><span class="p">,</span>
                                                          <span class="n">Log_Processor</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;删除失败，请检查邮箱地址是否正确&quot;</span><span class="p">)</span>

        <span class="c1"># 完成子窗口界面设置和映射</span>
        <span class="n">warning_processor</span> <span class="o">=</span> <span class="n">Warning_Processor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;发件人信息:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_info_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">warning_processor</span><span class="o">.</span><span class="n">email_senter_data</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender_info_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_sender_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;更换&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">change_sender</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_sender_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">receiver_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;收件人列表:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">receiver_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">email_window</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>

        <span class="c1"># Listbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Listbox</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">EXTENDED</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># 垂直滚动条</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_scrollbar</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_scrollbar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>
        <span class="c1"># 将滚动条连接到Listbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_scrollbar</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>
        <span class="c1"># 添加列表项</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">warning_processor</span><span class="o">.</span><span class="n">email_receiver_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">listbox</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">append_receiver_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;添加&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">append_receiver</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_receiver_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">email_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;删除&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">delete_receiver</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_receiver_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_receiver_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">bottom</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">email_window</span><span class="p">)</span>
        <span class="n">bottom</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">confirm_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;确认信息&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">confirm</span><span class="p">)</span>
        <span class="n">confirm_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


    <span class="c1"># # 与“测试”按钮绑定</span>
    <span class="c1"># def start_test(self):</span>
    <span class="c1">#     type_dict = {&#39;全部&#39;: 0, &#39;火焰&#39;: 1, &#39;人员&#39;: 2, &#39;异常情况&#39;: 3}</span>
    <span class="c1">#     print(self.visibility_var.get())</span>
    <span class="c1">#     print(self.detect_var.get())</span>
    <span class="c1">#     print(type_dict[self.detect_type_var.get()])</span>
    <span class="c1">#     print(self.save_var.get())</span>
    <span class="c1">#     print(self.sensitivity_var.get())</span>

<div class="viewcode-block" id="VideoMonitorApp.history_video_process_workder">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.history_video_process_workder">[文档]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">history_video_process_workder</span><span class="p">(</span><span class="n">shared_value</span><span class="p">,</span> <span class="n">shared_event</span><span class="p">,</span> <span class="n">video_strat_save_date</span><span class="p">,</span> <span class="n">video_index</span><span class="p">,</span>
                                      <span class="n">flag_visibility</span><span class="p">,</span> <span class="n">flag_re_detect</span><span class="p">,</span> <span class="n">video_detect_sensitivity</span><span class="p">,</span> <span class="n">video_detect_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        处理本地历史视频进程的工作函数，除共享内存对象和进程事件通信对象外</span>
<span class="sd">        其他传入参数类型和意义与视频流处理器的对应处理函数相同</span>
<span class="sd">        是一个静态方法，只通过传递的共享内存对象和进程事件通信对象进行进程间的交互</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vp</span> <span class="o">=</span> <span class="n">Video_Processor</span><span class="p">(</span><span class="n">url_capture_time_out</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">event</span><span class="o">=</span><span class="n">shared_event</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="n">shared_value</span><span class="p">)</span>
        <span class="n">vp</span><span class="o">.</span><span class="n">load_history_video</span><span class="p">(</span><span class="n">video_strat_save_date</span><span class="o">=</span><span class="n">video_strat_save_date</span><span class="p">,</span>
                              <span class="n">video_index</span><span class="o">=</span><span class="n">video_index</span><span class="p">,</span>
                              <span class="n">flag_visibility</span><span class="o">=</span><span class="n">flag_visibility</span><span class="p">,</span>
                              <span class="n">flag_re_detect</span><span class="o">=</span><span class="n">flag_re_detect</span><span class="p">,</span>
                              <span class="n">video_detect_sensitivity</span><span class="o">=</span><span class="n">video_detect_sensitivity</span><span class="p">,</span>
                              <span class="n">video_detect_type</span><span class="o">=</span><span class="n">video_detect_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.local_process_workder">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.local_process_workder">[文档]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">local_process_workder</span><span class="p">(</span><span class="n">shared_value</span><span class="p">,</span> <span class="n">shared_event</span><span class="p">,</span> <span class="n">video_sourse</span><span class="p">,</span> <span class="n">flag_visibility</span><span class="p">,</span>
                              <span class="n">flag_save</span><span class="p">,</span> <span class="n">flag_detect</span><span class="p">,</span> <span class="n">video_detect_sensitivity</span><span class="p">,</span> <span class="n">video_detect_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        处理本地视频设备进程的工作函数，除共享内存对象和进程事件通信对象外</span>
<span class="sd">        其他传入参数类型和意义与视频流处理器的对应处理函数相同</span>
<span class="sd">        是一个静态方法，只通过传递的共享内存对象和进程事件通信对象进行进程间的交互</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vp</span> <span class="o">=</span> <span class="n">Video_Processor</span><span class="p">(</span><span class="n">url_capture_time_out</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">event</span><span class="o">=</span><span class="n">shared_event</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="n">shared_value</span><span class="p">)</span>
        <span class="n">vp</span><span class="o">.</span><span class="n">load_local_video_device</span><span class="p">(</span><span class="n">video_sourse</span><span class="o">=</span><span class="n">video_sourse</span><span class="p">,</span>
                                   <span class="n">flag_visibility</span><span class="o">=</span><span class="n">flag_visibility</span><span class="p">,</span>
                                   <span class="n">flag_save</span><span class="o">=</span><span class="n">flag_save</span><span class="p">,</span>
                                   <span class="n">flag_detect</span><span class="o">=</span><span class="n">flag_detect</span><span class="p">,</span>
                                   <span class="n">video_detect_sensitivity</span><span class="o">=</span><span class="n">video_detect_sensitivity</span><span class="p">,</span>
                                   <span class="n">video_detect_type</span><span class="o">=</span><span class="n">video_detect_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.device_process_workder">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.device_process_workder">[文档]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">device_process_workder</span><span class="p">(</span><span class="n">shared_value</span><span class="p">,</span> <span class="n">shared_event</span><span class="p">,</span> <span class="n">video_sourse</span><span class="p">,</span> <span class="n">flag_visibility</span><span class="p">,</span>
                               <span class="n">flag_save</span><span class="p">,</span> <span class="n">flag_detect</span><span class="p">,</span> <span class="n">video_detect_sensitivity</span><span class="p">,</span> <span class="n">video_detect_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        处理网络视频设备进程的工作函数，除共享内存对象和进程事件通信对象外</span>
<span class="sd">        其他传入参数类型和意义与视频流处理器的对应处理函数相同</span>
<span class="sd">        是一个静态方法，只通过传递的共享内存对象和进程事件通信对象进行进程间的交互</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vp</span> <span class="o">=</span> <span class="n">Video_Processor</span><span class="p">(</span><span class="n">url_capture_time_out</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">event</span><span class="o">=</span><span class="n">shared_event</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="n">shared_value</span><span class="p">)</span>
        <span class="n">vp</span><span class="o">.</span><span class="n">load_network_video_device</span><span class="p">(</span><span class="n">video_sourse</span><span class="o">=</span><span class="n">video_sourse</span><span class="p">,</span>
                                     <span class="n">flag_visibility</span><span class="o">=</span><span class="n">flag_visibility</span><span class="p">,</span>
                                     <span class="n">flag_save</span><span class="o">=</span><span class="n">flag_save</span><span class="p">,</span>
                                     <span class="n">flag_detect</span><span class="o">=</span><span class="n">flag_detect</span><span class="p">,</span>
                                     <span class="n">video_detect_sensitivity</span><span class="o">=</span><span class="n">video_detect_sensitivity</span><span class="p">,</span>
                                     <span class="n">video_detect_type</span><span class="o">=</span><span class="n">video_detect_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="VideoMonitorApp.check_video_processor">
<a class="viewcode-back" href="../../../home_security_surveillance.Ui.html#home_security_surveillance.Ui.ui.VideoMonitorApp.check_video_processor">[文档]</a>
    <span class="k">def</span> <span class="nf">check_video_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        定义检查函数，每隔1s调用一次自身，</span>
<span class="sd">        用于检查正在处理视频流的Video_Processor进程实例是否结束，并刷新当前可用的本地视频设备</span>
<span class="sd">        如果未结束相当于只刷新本地视频设备，如果已结束会弹出进程返回错误信息所相应的提示窗口</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># process_type为1则为本地历史视频进程</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># 返回错误类型的对应信息</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;历史保存视频文件夹为空</span><span class="se">\n</span><span class="s2">请检查文件是否存在&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;要加载视频的日期无视频文件</span><span class="se">\n</span><span class="s2">请检查文件是否存在&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;找不到该视频文件，索引不存在</span><span class="se">\n</span><span class="s2">请检查文件是否存在&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;视频流打开失败</span><span class="se">\n</span><span class="s2">请检查文件格式是否正确&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;视频流意外关闭</span><span class="se">\n</span><span class="s2">请检查文件是否完好&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;监控进程已完成退出&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="c1"># 处理进程退出的后的ui变化</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">10</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;邮件管理&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish the worker process&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># process_type为2则为本地视频设备进程</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># 返回错误类型的对应信息</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;本地视频设备为空</span><span class="se">\n</span><span class="s2">请检查本地是否有视频设备&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;索引号超过了本地视频设备列表大小</span><span class="se">\n</span><span class="s2">请检查本地视频设备列表&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头打开失败</span><span class="se">\n</span><span class="s2">请检查或重新选择摄像头&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头下一帧读取失败</span><span class="se">\n</span><span class="s2">n请检查摄像头是否被关闭&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;保存视频文件时，创建目录或打开视频文件失败&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;监控进程已完成退出&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="c1"># 处理进程退出的后的ui变化</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">10</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;邮件管理&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish the worker process&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># process_type为3则为网络视频设备进程</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># 返回错误类型的对应信息</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;网络视频设备为空</span><span class="se">\n</span><span class="s2">请检查是否有已保存的url地址&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;网络设备视频传输协议不支持</span><span class="se">\n</span><span class="s2">请使用rtsp、http等格式的传输协议&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;从url获取视频流失败</span><span class="se">\n</span><span class="s2">请检查连接是否正常&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头打开超时</span><span class="se">\n</span><span class="s2">请检查url地址和对应的网络摄像头状态&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;摄像头下一帧读取失败</span><span class="se">\n</span><span class="s2">请检查摄像头是否被关闭&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;保存视频文件时，创建目录或打开视频文件失败&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="s2">&quot;提示&quot;</span><span class="p">,</span> <span class="s2">&quot;监控进程已完成退出&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="c1"># 处理进程退出的后的ui变化</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">10</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">9</span><span class="p">:</span>
                <span class="c1"># 销毁加载窗口</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loading_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_type</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_value</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shared_event</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">processes</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;开始&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">email_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">NORMAL</span><span class="p">)</span>  <span class="c1"># 将&quot;邮件管理&quot;按钮设为可用</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finish the worker process&quot;</span><span class="p">,</span> <span class="n">Log_Processor</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="c1"># 如果没有执行的进程，刷新本地摄像设备</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 如果本地设备更新了且目前是本地摄像设备，更新相关的内容</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">update_local_video_sourse</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;本地摄像设备&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">:</span>
                        <span class="c1"># 之前选择设备无法捕捉时，刷新为第一个可选的</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">video_processor</span><span class="o">.</span><span class="n">local_video_device_list</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_device_var</span><span class="p">,</span>
                                                            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">video_device_options</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video_device_menu</span><span class="p">[</span><span class="s1">&#39;menu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_font</span><span class="p">)</span>

        <span class="c1"># 重复检查</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">ms</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_video_processor</span><span class="p">)</span>
        <span class="k">return</span></div>
</div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">VideoMonitorApp</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">())</span>
    <span class="n">app</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">ms</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">check_video_processor</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, 07xiaohei、youyou、Chai.h、Captain.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7创建。
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>